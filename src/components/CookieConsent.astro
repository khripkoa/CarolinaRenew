---
// CookieConsent - Yandex-style consent banner for US (opt-out model)
---

<div
  x-data="{
    show: false,
    showSettings: false,
    preferences: {
      analytics: true,
      marketing: true,
      other: true
    },
    acceptAll() {
      localStorage.setItem('cookieConsent', JSON.stringify({
        accepted: true,
        analytics: true,
        marketing: true,
        other: true,
        timestamp: Date.now()
      }));
      this.show = false;
    },
    acceptEssential() {
      localStorage.setItem('cookieConsent', JSON.stringify({
        accepted: true,
        analytics: false,
        marketing: false,
        other: false,
        timestamp: Date.now()
      }));
      this.show = false;
    },
    savePreferences() {
      localStorage.setItem('cookieConsent', JSON.stringify({
        accepted: true,
        ...this.preferences,
        timestamp: Date.now()
      }));
      this.show = false;
      this.showSettings = false;
    }
  }"
  x-init="
    setTimeout(() => {
      const consent = localStorage.getItem('cookieConsent');
      if (!consent) {
        show = true;
      }
    }, 1500)
  "
  x-show="show"
  x-transition:enter="transition ease-out duration-300"
  x-transition:enter-start="translate-y-full opacity-0"
  x-transition:enter-end="translate-y-0 opacity-100"
  x-transition:leave="transition ease-in duration-200"
  x-transition:leave-start="translate-y-0 opacity-100"
  x-transition:leave-end="translate-y-full opacity-0"
  class="fixed bottom-0 left-0 right-0 z-50"
  style="display: none;"
  x-bind:style="show ? 'display: block' : 'display: none'"
>
  <!-- Main Banner -->
  <div
    x-show="!showSettings"
    class="bg-slate-800 border-t border-slate-700 shadow-2xl"
  >
    <div class="max-w-4xl mx-auto px-6 py-5">
      <div class="flex flex-col md:flex-row items-start md:items-center gap-4">
        <div class="flex-1">
          <h3 class="text-white font-semibold text-lg mb-1">
            Carolina Renew uses cookies
          </h3>
          <p class="text-slate-300 text-sm leading-relaxed">
            They ensure the smooth operation of our site and services. For more
            information, please read our
            <a
              href="/privacy/"
              class="text-amber-400 hover:text-amber-300 underline"
              >Cookie Policy</a
            >.
          </p>
        </div>
        <div class="flex flex-wrap gap-2 shrink-0">
          <button
            @click="acceptAll()"
            class="px-5 py-2.5 bg-amber-500 hover:bg-amber-400 text-slate-900 font-semibold rounded-full transition-colors shadow-lg"
          >
            Allow all
          </button>
          <button
            @click="acceptEssential()"
            class="px-5 py-2.5 bg-transparent border border-amber-500 text-amber-400 hover:bg-amber-500/10 font-medium rounded-full transition-colors"
          >
            Allow essential cookies
          </button>
          <button
            @click="showSettings = true"
            class="px-5 py-2.5 bg-slate-700 hover:bg-slate-600 text-slate-300 font-medium rounded-full transition-colors"
          >
            Settings
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Panel -->
  <div
    x-show="showSettings"
    x-transition:enter="transition ease-out duration-200"
    x-transition:enter-start="opacity-0 scale-95"
    x-transition:enter-end="opacity-100 scale-100"
    class="bg-slate-800 border-t border-slate-700 shadow-2xl"
  >
    <div class="max-w-2xl mx-auto px-6 py-6">
      <h3 class="text-white font-semibold text-xl mb-2">Cookie settings</h3>
      <p class="text-slate-400 text-sm mb-6 leading-relaxed">
        Carolina Renew uses technical cookies to ensure the site functions
        properly. However, we would also like to use optional marketing,
        analytics, and other types of cookies. These cookies help us improve
        services, your experience, and ad relevancy. For more information about
        cookies, please read our
        <a
          href="/privacy/"
          class="text-amber-400 hover:text-amber-300 underline">Cookie Policy</a
        >.
      </p>

      <div class="space-y-4 mb-6">
        <!-- Technical (Always On) -->
        <div
          class="flex items-center justify-between py-3 border-t border-slate-700"
        >
          <div class="flex items-center gap-3">
            <span class="text-slate-500 text-lg">+</span>
            <span class="text-white font-medium">Technical, always active</span>
          </div>
          <div
            class="w-12 h-6 bg-slate-600 rounded-full relative cursor-not-allowed"
          >
            <div
              class="absolute right-1 top-1 w-4 h-4 bg-slate-400 rounded-full"
            >
            </div>
          </div>
        </div>

        <!-- Analytics/Marketing -->
        <div
          class="flex items-center justify-between py-3 border-t border-slate-700"
        >
          <div class="flex items-center gap-3">
            <span class="text-slate-500 text-lg">+</span>
            <span class="text-white font-medium">Analytics/marketing</span>
          </div>
          <button
            @click="preferences.analytics = !preferences.analytics; preferences.marketing = !preferences.marketing"
            class="w-12 h-6 rounded-full relative transition-colors"
            :class="preferences.analytics ? 'bg-amber-500' : 'bg-slate-600'"
          >
            <div
              class="absolute top-1 w-4 h-4 bg-white rounded-full transition-all"
              :class="preferences.analytics ? 'right-1' : 'left-1'"
            >
            </div>
          </button>
        </div>

        <!-- Other Cookies -->
        <div
          class="flex items-center justify-between py-3 border-t border-slate-700"
        >
          <div class="flex items-center gap-3">
            <span class="text-slate-500 text-lg">+</span>
            <span class="text-white font-medium">Other cookies</span>
          </div>
          <button
            @click="preferences.other = !preferences.other"
            class="w-12 h-6 rounded-full relative transition-colors"
            :class="preferences.other ? 'bg-amber-500' : 'bg-slate-600'"
          >
            <div
              class="absolute top-1 w-4 h-4 bg-white rounded-full transition-all"
              :class="preferences.other ? 'right-1' : 'left-1'"
            >
            </div>
          </button>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <button
          @click="showSettings = false"
          class="w-10 h-10 flex items-center justify-center bg-slate-700 hover:bg-slate-600 rounded-full transition-colors"
        >
          <svg
            class="w-5 h-5 text-slate-300"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 19l-7-7 7-7"></path>
          </svg>
        </button>
        <button
          @click="savePreferences()"
          class="flex-1 px-5 py-2.5 bg-amber-500 hover:bg-amber-400 text-slate-900 font-semibold rounded-full transition-colors"
        >
          Allow selected cookies
        </button>
        <button
          @click="acceptEssential()"
          class="px-5 py-2.5 bg-slate-700 hover:bg-slate-600 text-slate-300 font-medium rounded-full transition-colors"
        >
          Allow essential cookies
        </button>
      </div>
    </div>
  </div>
</div>
